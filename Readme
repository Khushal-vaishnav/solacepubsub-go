
ğŸš€ Solace PubSub+ Event-Driven Platform (End-to-End DevOps Project)

This project demonstrates a production-style event-driven architecture using Solace PubSub+, Go microservices, Kubernetes, Prometheus/Grafana, HPA with external metrics, CI/CD to GHCR, GitOps with ArgoCD, and Infrastructure provisioning with Terraform (EKS).

The goal of this project is to showcase real-world platform engineering and DevOps practices, not toy examples.

ğŸ§  What This Project Proves

Event-driven messaging with Solace PubSub+
Go-based producer / consumer microservices
Kubernetes-native deployment (kind + EKS)
Prometheus metrics instrumentation
Autoscaling using external metrics
CI/CD pipelines pushing images to GHCR
GitOps reconciliation with ArgoCD
Infrastructure as Code using Terraform
Cost-safe AWS usage (create â†’ validate â†’ destroy)

ğŸ—ï¸ Architecture Overview
High-level Flow
Producer (Go)
   â”‚
   â–¼
Solace PubSub+ Broker
   â”‚
   â–¼
Consumer (Go)
   â”‚
   â–¼
Prometheus â†’ Grafana
   â”‚
   â–¼
HPA (External Metrics)

Control Plane
Kubernetes (kind locally / EKS on AWS)
ArgoCD for GitOps
Terraform for infra provisioning

ğŸ“‚ Repository Structure
.
â”œâ”€â”€ run.go/                  # Go producer & consumer
â”‚   â”œâ”€â”€ producer.go
â”‚   â”œâ”€â”€ consumer.go
â”‚   â”œâ”€â”€ Dockerfile.producer
â”‚   â””â”€â”€ Dockerfile.consumer
â”‚
â”œâ”€â”€ k8s/                     # Base Kubernetes manifests
â”‚   â”œâ”€â”€ deployment-producer.yaml
â”‚   â”œâ”€â”€ deployment-consumer.yaml
â”‚   â”œâ”€â”€ service-producer.yaml
â”‚   â”œâ”€â”€ service-consumer.yaml
â”‚   â”œâ”€â”€ solace-app-config.yaml
â”‚   â”œâ”€â”€ solace-app-secret.yaml
â”‚   â””â”€â”€ consumer-hpa.yaml
â”‚
â”œâ”€â”€ monitoring/              # Observability stack
â”‚   â”œâ”€â”€ prometheus-config.yaml
â”‚   â”œâ”€â”€ prometheus-deployment.yaml
â”‚   â”œâ”€â”€ prometheus-service.yaml
â”‚   â”œâ”€â”€ grafana-deployment.yaml
â”‚   â”œâ”€â”€ grafana-service.yaml
â”‚   â”œâ”€â”€ grafana-dashboard-provider.yaml
â”‚   â””â”€â”€ grafana-dashboard-solace.yaml
â”‚
â”œâ”€â”€ solace-gitops/            # GitOps source of truth
â”‚   â”œâ”€â”€ argocd-solace-app.yaml
â”‚   â”œâ”€â”€ solace/               # App manifests (deployments, hpa)
â”‚   â””â”€â”€ monitoring/           # Prometheus & Grafana manifests
â”‚
â”œâ”€â”€ .github/workflows/
â”‚   â””â”€â”€ ci-build-push.yaml    # CI â†’ GHCR
â”‚
â”œâ”€â”€ terraform/                # Infrastructure as Code
â”‚   â”œâ”€â”€ main.tf
â”‚   â””â”€â”€ modules/
â”‚       â”œâ”€â”€ vpc/
â”‚       â””â”€â”€ eks/
â”‚
â””â”€â”€ README.md

âš™ï¸ Phase 1: Local Setup (Docker + kind)
1ï¸âƒ£ Run Solace PubSub+ Broker
docker run -d \
  -p 8080:8080 -p 1943:1943 -p 55555:55555 \
  --env username_admin_globalaccesslevel=admin \
  --env username_admin_password=admin \
  --shm-size=2g \
  --name=solace \
  solace/solace-pubsub-standard
Access UI:
ğŸ‘‰ http://localhost:8080
Login: admin / admin

2ï¸âƒ£ Build Producer & Consumer Images
docker build -t solace-producer:local -f Dockerfile.producer .
docker build -t solace-consumer:local -f Dockerfile.consumer .

3ï¸âƒ£ Create Kubernetes Cluster
kind create cluster --name solace-lab
kind load docker-image solace-producer:local --name solace-lab
kind load docker-image solace-consumer:local --name solace-lab

4ï¸âƒ£ Deploy Applications
kubectl create namespace solace
kubectl apply -f k8s/ -n solace

ğŸ“Š Phase 2: Observability (Prometheus + Grafana)
Metrics Exposed
solace_messages_published_total
solace_messages_consumed_total
solace_publish_errors_total
solace_consume_errors_total
Deploy Monitoring Stack
kubectl create namespace monitoring
kubectl apply -f monitoring/ -n monitoring
Access
Prometheus: kubectl port-forward svc/prometheus 9090:9090 -n monitoring
Grafana: kubectl port-forward svc/grafana 3000:3000 -n monitoring
user/pass: admin / admin

ğŸ“ˆ Phase 3: Autoscaling with External Metrics
Prometheus Adapter exposes custom metric:
solace_message_lag
HPA scales consumer pods based on lag
Scaling can be paused safely:
minReplicas: 1
maxReplicas: 1
This demonstrates GitOps-controlled autoscaling guardrails.

ğŸ”„ Phase 4: CI/CD â†’ GHCR
GitHub Actions Workflow
Builds producer & consumer
Tags images with Git SHA
Pushes to GHCR
Example image:
ghcr.io/khushal-vaishnav/solace-consumer:<commit-sha>
This enables immutable deployments.

â™»ï¸ Phase 5: GitOps with ArgoCD
ArgoCD Application
source:
  repoURL: https://github.com/Khushal-vaishnav/solacepubsub-go.git
  path: solace-gitops/solace
Git is the Source of Truth
Any drift (kubectl scale/edit) is detected
ArgoCD reconciles automatically
Supports self-heal + prune

â˜ï¸ Phase 6: Infrastructure with Terraform (AWS EKS)
What Was Provisioned
VPC
2 subnets
EKS control plane (no nodes)
terraform init
terraform validate
terraform plan
terraform apply
terraform destroy

ğŸ§¹ Cleanup
kubectl delete ns solace monitoring argocd
kind delete cluster --name solace-lab
terraform destroy
